"""\nTTM Metrics API - FastAPI application\nHandles all PR logging, workout tracking, and XP management\n"""\n\nfrom fastapi import FastAPI, Depends, HTTPException\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom sqlalchemy.orm import Session\nfrom sqlalchemy import and_, or_\nfrom typing import List, Optional\nfrom datetime import datetime, timedelta\nimport secrets\nimport re\nimport os\n\nfrom database import (\n    get_db, init_db, PR, Workout, WorkoutCompletion, UserXP,\n    DashboardMember, CoreFoodsLog as CoreFoodsLogModel, WeeklyLog,\n    CoreFoodsCheckin, UserNote, ExerciseSwap, WorkoutSession,\n    SessionLocal\n)\nfrom schemas import (\n    PRCreate, PRResponse, BestPRResponse,\n    WorkoutPlanCreate, WorkoutCompletionUpdate, DeloadStatus,\n    XPAward, XPResponse,\n    DashboardMemberCreate, DashboardMemberResponse,\n    CoreFoodsLog\n)\nfrom config import XP_REWARDS_API, XP_ENABLED\nfrom admin_dump import router as admin_dump_router\nfrom admin_rebuild import router as admin_rebuild_router\nfrom admin_core_foods import router as admin_core_foods_router\nfrom main_extra_routes import router as extra_routes_router\n\napp = FastAPI(\n    title=\"TTM Metrics API\",\n    description=\"Three Target Method - Fitness tracking and gamification API\",\n    version=\"1.5.7\"\n)\n\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\napp.include_router(admin_dump_router)\napp.include_router(admin_rebuild_router)\napp.include_router(admin_core_foods_router)\napp.include_router(extra_routes_router)